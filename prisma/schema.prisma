// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

// Looking for ways to speed up your queries, or scale easily with your serverless or edge functions?
// Try Prisma Accelerate: https://pris.ly/cli/accelerate-init

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model Session {
  id           String   @id @default(cuid())
  userId       Int
  expires      DateTime
  sessionToken String   @unique
  accessToken  String   @unique
  createdAt    DateTime @default(now())
  updatedAt    DateTime @updatedAt
  user         User     @relation(fields: [userId], references: [id])
}

model User {
  id               Int                @id @default(autoincrement())
  username         String?            @unique
  email            String?            @unique
  password         String?
  firstname        String?
  lastname         String?
  tel              String
  image            String
  license          String
  role             String             @default("user")
  empId            Int?
  companyId        Int
  company          Company            @relation(fields: [companyId], references: [id])
  departmentId     Int
  department       Department?        @relation(fields: [departmentId], references: [id])
  positionId       Int
  position         Position?          @relation(fields: [positionId], references: [id])
  createdAt        DateTime           @default(now())
  updatedAt        DateTime           @updatedAt
  RequestEquipment RequestEquipment[]
  ApproveEquipment ApproveEquipment[]
  Session          Session[]
}

model Company {
  id   Int     @id @default(autoincrement())
  name String? @unique
  User User[]
}

model Department {
  id   Int     @id @default(autoincrement())
  name String? @unique
  User User[]
}

model Position {
  id   Int     @id @default(autoincrement())
  name String? @unique
  User User[]
}

model RequestEquipment {
  id               Int                @id @default(autoincrement())
  purpose          String
  requestDate      DateTime           @default(now())
  requestById      Int
  requestBy        User?              @relation(fields: [requestById], references: [id])
  completeDate     DateTime           @default(now())
  step             Int                @default(1)
  allStatus        String             @default("Waiting")
  remark           String             @default("")
  ApproveEquipment ApproveEquipment[]
  Equipment        Equipment[]
}

model ApproveEquipment {
  id          Int               @id @default(autoincrement())
  requestId   Int
  request     RequestEquipment? @relation(fields: [requestId], references: [id])
  approveById Int
  approveBy   User?             @relation(fields: [approveById], references: [id])
  step        Int
  allStatus   String
}

model Equipment {
  id        Int               @id @default(autoincrement())
  assetId   Int
  asset     Asset?            @relation(fields: [assetId], references: [id])
  detail    String
  qty       Int
  requestId Int
  request   RequestEquipment? @relation(fields: [requestId], references: [id])
}

model Asset {
  id        Int         @id @default(autoincrement())
  name      String      @unique
  assetType String
  Equipment Equipment[]
}
